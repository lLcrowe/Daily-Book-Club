# 데이터 모델링 이론
---
## 데이터 모델링이란?
- 데이터 모델 : 현실 세계의 정보나 데이터를 시스템적으로 구축하기 위해 추상화하여 체계적으로 표현한 모형
- 데이터 모델링 : 영속성을 갖는 데이터에 대한 시스템 구조를 사람이 이해할 수 있도록 형상화하는 과정.
사람이 정보로서 의미있는 대상을 인지하고, 식별하는 과정`(개념적)`을 거쳐 식별한 것을 기호 등을 통해 추상화하여 표현`(논리적)`하고, 정보시스템의 데이터베이스로 구축하기 위해 추상화된 모델을 구체화된 형태로 변환한다`(물리적)`.

### 데이터 모델의 종류
- 개체관계 모델 (ER, Entity-Relationship Model) : 대표적인 데이터 모델
- 계층 모델(Hierarchical Model)
- 망 모델(Network model)

### 한 엔티티에서 모든 데이터를 관리할 경우 문제점(식당 입장에서)
- 주문이 발생할 때마다 매장 정보를 관리해야 함
- 상품을 default로 넣어둔 값까지만 관리할 수 있음

### 데이터 모델링 : 현행 업무를 파악하여 개념들을 정리하고 분류하여 엔티티, 속성, 관계로 형상화하는 과정
- 엔티티 : 도출된 개념 중 복합 정보를 포괄적으로 수용하고 있는 경우(상품, 가입 등)
- 속성 : 단일 정보(생년월일, 가입 금액 등)

### ER 모델(Entity-Relationship Model)
- 표현하고자 하는 현실 세계의 업무를 개체(또는 실체, Entity)와 관계(Relationship)라는 두 가지 개념으로 표현하는 모델로 1976년 P.P.Chen이 처음 제안
- ERD(Entity-Relationship Diagram)는 ER모델에서 사용하는 실체와 관계를 도식화한 것으로, 실체와 이들 간의 관계를 알기 관계를 알기 쉽도록 미리 약속한 도형을 사용하여 표현하였다.
- ER 표기법은 규약과 동시에 언어이다.
## ER 모델의 질적 특성
* ### 완전성(Completeness)
    - ER 모델은 현실 세계의 모든 업무사항을 표현하고 있어야 한다.
    - 요구사항에 대한 상세 내용이 ER 모델에 모두 표현되어 있는지 찾아봐야 한다.
    - 상품 단가가 변경된다면 주문 시 상품 수량뿐 아니라 상품 금액을 같이 관리해야 한다.
* ### 정확성(Correctness)
    - ER 모델의 개념대로 데이터모델을 작성해야 한다.
    - 엔티티 대신 속성을 사용하지 않아야 한다.
    - 슈퍼타입 관계를 명확히 해야 한다.
    - 슈퍼타입과 서브타입 사이의 상속(Inheritance)을 표현하고, 관계와 관련된 개별 엔티티를 명확히 정의해야 한다.
    - 관계 대신 엔티티를 사용하지 않는다.
    - 실체의 식별자를 명확히 해야 한다.
    - 카디널리티와 옵셔널리티를 명확하게 표현해야 한다.
    - 한 명의 직원이 두 개 이상 부서의 부서장으로 겸임할 수 있고, 부서장이 공석일 수도 있다.
* ### 최소성(Minimality)
    - 요구사항의 모든 특성이 ER모델에 한번만 나타나도록 설계해야 한다.
    - 중복이 있으면 중복 데이터를 반드시 문서화해야 한다.
    - 부서와 직원 엔티티에서 특정 부서의 직원 수는 직원 엔티티에서 특정 부서에 속한 직원 수를 구하면 되므로, 부서에서 직원 수 속성을 가지고 있을 필요는 없다.
* ### 자명성(Self-explanation)
    - 별도의 보조자료 없이도 요구사항에 대한 뜻이나 의미를 명확하게 설명할 수 있어야 한다.
    - 쇼핑몰에서 주문한 사람과 받는 사람이 다를 수 있으므로, 배송정보를 별도로 관리하여 요구사항을 반영할 수 있다.
* ### 확장성(Extensibility)
    - 향후 업무범위나 규모가 확대되거나 변경될 경우 새로운 요구사항을 쉽게 반영할 수 있도록 유연한 모델을 설계해야 한다.
    - 대표적인 방법으로는, 엔티티를 일반화하여 엔티티를 통합하는 것이다.
    - 고객 유형 속성을 추가하여 기존의 [개인, 법인] 이외에도 [단체] 등으로 고객 범위를 확장할 수 있고, 고객 유형에 따라 [주민등록번호, 법인등록번호, 단체등록번호] 등으로 식별 가능하다.
* ### 표현성(Expressiveness)
    - ER모델은 요구사항을 자연스럽게 표현하고 추가적인 설명 없이도 ER모델의 의미를 쉽게 이해할 수 있도록 명확하게 설계해야 한다.
    - [주소1, 주소2] -> [고객기본주소, 고객상세주소]가 옳다.
* ### 가독성(Readability)
    - ER 모델을 읽기 쉽고 그 뜻을 알아차릴 수 있도록 표현해야 한다.
    - '좌 상 우 하'가 best
    - 엔티티 크기는 속성의 수를 고려해서 그리고,
    - 순환관계, 부분집합 표현 시 부모 엔티티를 자식 엔티티 위에 표현한다.
    - 관계는 굽은 선을 최소화하고, 수직/수평 직선을 사용하고,
    - 관계선의 교차를 최소화한다. 속성은 중요한 정보를 위쪽에 표시하고, 비슷한 특성을 서로 가까운 위치에 표시한다.
--- 
## ER 모델 구성 요소
- ER모델의 구성요소로는 `엔티티`(Entity), `관계`(Relationship), `속성`(Attribute)등이 있으며, 속성과 관계 중 하나 이상의 조합으로 구성된 식별자(Identifier)를 포함한다.
### 엔티티(Entity) 
- 엔티티는 주문, 계약처럼 실체와 실체 간의 관계에 해당하는 엔티티를 포함한다.
- 엔티티는 적어도 둘 이상의 인스턴스가 존재할 수 있어야 하고,
- 최소한 둘 이상의 속성이 있어야 하며,
- 반드시 각 인스턴스를 식별할 수 있는 속성이나 관계가 하나 이상 정의되어야 한다.

> 우리가 일반적으로 이야기하는 엔티티는 정확히 말하면 엔티티 타입(Entity Type)이다. 엔티티는 엔티티타입의 실체(인스턴스)에 해당한다. 
> 고객 = 엔티티 타입, 그리고 고객인 '김머현'이 엔티티에 해당한다.

### 슈퍼타입, 서브타입 엔티티(Supertype, Subtype)
- 일반화/특수화 과정을 통해 도출된다.
- 슈퍼타입 엔티티는 하나 이상의 서브타입 엔티티와 관계된 일반화된 엔티티이며, 서브타입 속성을 관리한다.
- 서브타입 엔티티는 각각의 서브타입에만 존재하는 고유한 속성을 관리한다.
- 서브타입은 슈퍼타입의 식별자, 속성, 관계 등 모든 특성을 상속받는다.
- 고객의 공통 속성인 고객명, 주소는 슈퍼타입 엔티티에서 관리하고, 주민등록번호는 개인고객만 해당하므로 서브타입 엔티티인 개인고객 엔티티에서 관리하고, 법인등록번호는 법인고객 엔티티에서 관리한다.
### 일반화(Generalization)
- 엔티티의 일반화는 엔티티 각각이 가지고 있는 고유한 특징을 일반화하여 공통의 속성으로 재정의한 것이다.
- 보편적인 의미보다는 공통적인 의미에 더 가깝다고 볼 수 있다.
- 개인과 기업의 공통적인 성격을 묶어 고객으로 정의하고, 제품과 상품을 큰 틀에서 상품으로 재정의한 것이기도 하다.
- 엔티티의 일반화는 두 개 이상의 하위 수준(개인고객, 법인고객) 엔티티를 결합하여 상위 수준(고객 엔티티)의 엔티티로 통합하는 상향적 접근 방식이다.
- 또한  상위 수준의 엔티티와 하위 수준의 엔티티를 일반화하여 표현할 수도 있다.

### 특수화(Specialization)
- 특수화는 일반화의 반대 개념으로, 하나의 상위 수준 엔티티를 두 개 이상의 하위 수준 엔티티로 분할하는 하향식 접근방식이다.
- 개인고객과 법인고객을 고객 엔티티 하나로 관리할 경우, 어떤 속성이 개인고객 속성인지 법인고객 속성인지 알 수 없다. 특수화를 통해 그들에 해당하는 속성을 식별함으로써 업무규칙을 제대로 반영할 수 있게 된다.

### 집단화(Aggregation)
- 기본 ER모델의 표기법은 다른 관계를 포함하는 관계를 표현할 수 없다.
- 예를 들어, '고객이 상품을 주문하고, 주문한 상품을 택배 회사가 배송한다' 에서, 주문과 배송만을 연결할 경우 문제가 발생한다.
- 이 때, 고객과 주문, 상품을 집단화함으로써 배송과 한꺼번에 연관지어 줄 수 있다.

### 엔티티의 분류
- 엔티티 관계에 따라 강한 엔티티, 약한 엔티티로 나눈다.
- 엔티티 형태에 따라서 독립 엔티티, 업무중심 엔티티, 종속 엔티티, 교차 엔티티로 나눈다.
	- 독립 엔티티 : 사람, 상품, 창고, 조직 등
	- 업무중심 엔티티 : 주문, 결제, 배송, 청구 등
	- 종속 엔티티 : 주로 업무중심 엔티티에서 1차 정규화로 인해 분리된 엔티티에 해당한다.
		- 예) 주문상품, 주문배송은 주문 엔티티가 있어야 존재할 수 있는 엔티티이다.
	- 교차 엔티티 : 두 개 이상의 엔티티 간에 발생하는 트랜잭션에 의해 생성되는 엔티티
		- 보통 다대다 관계에서 중간 테이블로 많이 이용된다.
- `엔티티 생성`에 따라서 핵심 엔티티, 중요 엔티티, 행위 엔티티로 구분한다.
	- 핵심 엔티티 : 고객, 상품, 조직처럼 부모 엔티티를 갖지 않는 독립적, 핵심적 엔티티
	- 중요 엔티티 : 핵심 엔티티 간의 거래 관계에 의해 생성되는 엔티티지만 업무의 핵심이 된다.
		- 예) 계약은 고객과 상품의 거래 관계에 의해 생성되며, 고객과 상품을 부모로 갖는다.
	- 행위 엔티티 : 실제 업무 행위에 의해 지속해서 발생하는 거래 행위에 대한 엔티티이다.
- 엔티티 형태에 따라 실체 엔티티와 비실체 엔티티로 분류하고, 비실체 엔티티는 개념 엔티티와 사건 엔티티로 나뉜다.
