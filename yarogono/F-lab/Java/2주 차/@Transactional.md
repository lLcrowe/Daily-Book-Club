# 🔗 참고자료

---

- Tecoble - Transactional 어노테이션 ⇒ [**링크**](https://tecoble.techcourse.co.kr/post/2021-05-25-transactional/)
- fauna - What is a database transaction? ⇒ [**링크**](https://fauna.com/blog/database-transaction)
- DB 데드락 ⇒ **[링크](https://velog.io/@sweet_sumin/DB-%EB%8D%B0%EB%93%9C%EB%9D%BD)**
- 오라클 Docs - deadlock ⇒ [**링크**](https://docs.oracle.com/javadb/10.6.2.1/devguide/cdevconcepts28436.html)

# ✏공부 내용 정리

---

## ❓@Transcational이란

스프링에서 어노테이션을 이용해서 트랜잭션을 처리하는 방법이다.

@Transactional을 알기 위해서는 결국 트랜잭션에 대해 알아야 한다고 생각했다.

## ❓트랜잭션이란

- Transaction의 뜻은 거래이다.
- 데이터베이스의 상태를 변화시키기 위해 수행하는 작업의 단위를 뜻한다.
- 이 작업의 단위는 쪼갤 수 없는 업무 처리의 최소 단위이다.

즉, 작업의 절반만 수행하고 결과를 저장하는 경우는 절대 없다.

트랜잭션의 단위는 시스템이 실패 한 경우 취소하여 데이터베이스를 원래 상태로 되돌릴 수 있다.

일반적으로 **롤백**과 같은 용어는 트랜잭션에 의해 변경된 사항을 취소하는 프로세스를 말하며,

**커밋**이라는 용어는 트랜잭션에 의해 영구적으로 변경된 사항을 적용된 것을 말한다.

*실행(COMMIT)과 취소(ROLLBACK)

### 번 외(DB 데드락)

## DB 데드락과 트랜잭션의 관계

‘교착 상태’ 라고 하며, 두 개 이상의 작업이 서로 상대방의 작업이 끝나기 만을 기다리고 있기 때문에 결과적으로 아무것도 완료되지 못하는 상태를 가리킨다.

데드락에 대해 한글로 된 블로그를 찾아보니까 대부분 같은 내용으로 작성되어 있었다.

> 두 개 이상의 프로세스나 스레드가 서로 자원을 얻지 못해서 다음 처리를 하지 못하는 상태
>
>
> 무한히 다음 자원을 기다리게 되는 상태를 말한다.
>
> 시스템적으로 한정된 자원을 여러 곳에서 사용하려고 할 때 발생한다.
>

위 내용이 정말 잘 정리되어 있지만 지금 공부하는 내용과는 연결성이 조금 부족하다고 생각했다.

기억을 더듬어보니 멘토링 시간에 Transaction 내용이 나오다가 데드락 개념이 나오게 된 것 같았다.

그래서 DB DeadLock 을 찾아보기로 했다.

## ❓DB 데드락(DeadLock)이란

> DB에서 ‘교착 상태’ 는 둘 이상의 트랜잭션이 서로 Lock을 포기하기를 기다리는 상황입니다.
>

오라클 Docs를 보니 간결하게 위와 같이 정리가 되어 있었다.

그렇다면 어떤 상황에서 데드락이 발생할까?

(예시도 오라클 Docs에 잘 정리되어 있어서 그대로 가져와 봤다.)

## 데드락이 발생하는 상황

![dead.gif](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3af5837f-594a-47ce-a093-d2dba2a50cab/dead.gif)

예를 들어 트랜잭션 A는 계정 테이블의 일부 행에 대한 Lock을 보유할 수 있으며

완료하려면 주문 테이블의 일부 행을 업데이트해야 합니다 . 

트랜잭션 B는 Orders 테이블의 바로 그 행에 대한 Lock을 보유하고 있지만

트랜잭션 A가 보유한 계정 테이블 의 행을 업데이트해야 합니다 .

트랜잭션 A는 주문 에 대한 Lock 때문에 트랜잭션을 완료할 수 없습니다 . 

트랜잭션 B는 계정 Lock으로 인해 트랜잭션을 완료할 수 없습니다 . 

DBMS가 교착 상태(DeadLock)를 감지하고 트랜잭션 중 하나를 중단하지 않는 한

모든 활동이 중단되고 영원히 정지 상태로 유지됩니다.

# 공부하면서 느낀 점

---

일주일 계획을 제대로 세워서 각 논의 내용을 정리할 데드라인을 정해야겠다.

시간을 좀 더 활용해서 하나의 논의 주제에만 빠지지 않도록 하자