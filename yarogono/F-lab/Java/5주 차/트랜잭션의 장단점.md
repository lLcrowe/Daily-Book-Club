# 🔗 참고자료

---

- 망나니 개발자 블로그 - [Database] 8. 트랜잭션, 동시성 제어, 회복 ⇒ ****[링크](https://mangkyu.tistory.com/30)****
- [데이터베이스] 트랜잭션(Transaction)에대한 고찰 ⇒ **[링크](https://pjh3749.tistory.com/225)**
- 책 <RealMySQL> 155p - 5.1 트랜잭션

# ✏공부 내용 정리

---

## 트랜잭션의 장점

- 부분 업데이트(Partial Update) 현상을 방지한다.
    - 로직에 맞게 나눈 트랜잭션 단위에서의 쿼리 중 일부라도 오류가 발생하면 전체를 원 상태로 만든다.(롤백)
    - 부분 업데이트 현상은 테이블 데이터의 정합성을 맞추는데 상당히 어려운 문제를 만든다.
      *정합성(Integrity) : 서로 모순이 없이 일관되게 일치해야 한다는 의미. 데이터의 값이 서로 일치해야 한다.
    - 부분 업데이트 현상이 발생하면 실패한 쿼리로 인해 남은 레코드를 다시 삭제하는 재처리 작업이 필요할 수 있다.

## 트랜잭션의 단점

- 개발자가 선정해둔 트랜잭션의 범위가 DBMS 서버의 높은 부하 상태로 빠지거나 위험한 상태로 만들 수 있다.
    - 코드 라인이 한두 줄 이라고 하더라도 네트워크 작업에 부하를 줄 수 있다고 한다.
    - DBMS의 커넥션과 동일하게 꼭 필요한 최소의 코드에만 적용하는 것이 좋다.
      ⇒ 프로그램 코드에서 트랜잭션의 범위를 최소화
    - 예시) 게시물을 작성한 후 저장 버튼을 클릭 했을 때 서버에서 처리하는 순서
        1. 처리 시작
           ⇒ 데이터베이스 커넥션 생성
           ⇒ 트랜잭션 시작
        2. 사용자의 로그인 여부 확인
        3. 사용자의 글쓰기 내용의 오류 여부 확인
        4. 첨부로 업로드된 파일 확인 및 저장
        5. 사용자의 입력 내용을 DBMS에 저장
        6. 첨부된 파일 정보를 DBMS에 저장
        7. 저장된 내용 또는 기타 정보를 DBMS에서 조회
        8. 게시물 등록에 대한 알림 메일 발송
        9. 알림 메일 발송 이력을 DBMS에 저장
           ≤== 트랜잭션 종료 (COMMIT)
           ≤== 데이터베이스 커넥션 반납
        10. 처리 완료

        - 일반적으로 데이터베이스 커넥션은 개수가 제한적이어서 각 단위 프로그램이 커넥션을 소유하는 시간이 길어질수록 사용 가능한 여유 커넥션의 개수는 줄어든다.
          ⇒ 각 단위 프로그램에서 커넥션을 가져가기 위해 기다려야 하는 상황이 발생할 위험
        - 더 큰 위험은 8번 작업이라고 볼 수 있다.
          FTP 파일 전송 작업 또는 네트워크를 통해 원격 서버와 통신하는 등과 같은 작업은
          어떻게 해서든 DBMS의 트랜잭션 내에서 제거하는 것이 좋다.
          프로그램이 실행되는 동안 메일 서버와 통신할 수 없는 상황이 발생한다면 웹 서버뿐 아니라 DBMS 서버까지 위험해지는 상황이 발생할 것이다.
        - 위 작업에는 크게 4개의 작업이 있다.
          각각의 트랜잭션은 별도로 분리 하는 것이 좋다.
- 프로그래머가 트랜잭션이 필요 없는 부분에서도 트랜잭션 처리를 할 수 있다.

## 궁금한 점

- 트랜잭션은 무엇일까?
- 트랜잭션 로깅은 어떻게 확인하는지?
- 트랜잭션 로깅을 코그 단에서도 처리를 해야 하는지?