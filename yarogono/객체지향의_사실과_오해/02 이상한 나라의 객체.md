# 02) 이상한 나라의 객체

> 객체지향 패러다임은 지식을 추상화하고 추상화한 지식을 객체 안에 캡슐화함으로써
실세계 문제에 내재된 복잡성을 관리하려고 한다. 객체를 발견하고 창조하는 것은
지식과 행동을 구조화하는 문제다.  
레베카 워프스브록(Rebecca Wirfs-Brock 1990) -
>

# 1️⃣객체지향과 인지 능력

---

- 객체지향이 세상을 자율적이고 독립적인 객체들로 분해할 수 있는 인간의 기본적인 인지 기반 능력에 기반을 두고 있다.
    - 많은 사람들이 객체지향을 직관적이고 이해하기 쉬운 패러다임이라고 말하는 이유

### 객체란?

인간이 분명하게 인지하고 구별할 수 있는 물리적인 또는 개념적인 경계를 지닌 어떤 것이다.

- 인간은 더 단순한 객체들로 주변을 분해함으로써 자신이 몸담고 있는 세상을 이해하려고 노력

### 객체지향 패러다임

인간이 인지할 수 있는 다양한 객체들이 모여 현실 세계를 이루는 것처럼 소프트웨어의 세계 역시 인간이 인지할 수 있는 다양한 소프트웨어 객체들이 모여 이뤄져 있다는 믿음에서 출발

- 현실 세계를 모방하는 것이 아니라 현실 세계를 기반으로 새로운 세계를 창조하는 것
    - 현실 세계의 객체와 소프트웨어 세계 객체는 전혀 다른 모습을 보인다.

# 2️⃣객체, 그리고 이상한 나라

---

## 앨리스 객체

엘리스의 특징

- 엘리스는 상태를 가지며 상태는 변경 가능하다.
- 엘리스의 상태를 변경시키는 것은 앨리스의 행동이다.
    - 행동의 결과는 상태에 의존적이며 상태를 이용해 서술할 수 있다.
    - 행동의 순서가 결과에 영향을 미친다.
- 엘리스는 어떤 상태에 있더라도 유일하게 식별 가능하다.

저자가 이상한 나라에 떨어진 앨리스가 객체지향 세계에 떨어진 객체들과 중요한 공통점 몇 가지를 설명하기 위해 ‘이상한 나라의 앨리스’ 책 내용을 얘기하고 있다.

# 3️⃣객체, 그리고 소프트웨어 나라

---

> 하나의 개별적인 실체로 식별 가능한 물리적인 또는
개념적인 사물은 어떤 것이라도 객체가 될 수 있다.
>
- 인간의 인지 능력 안에서 개수를 셀 수 있다.
- 다른 사물과 구분할 수 있다.
- 생성 시점을 알 수 있다.
- 독립적인 하나의 단위로 인식할 수 있는 모든 사물은 객체다.

### 객체란

식별 가능한 개체 또는 사물이다. 객체는 자동차처럼 만질 수 있는 구체적인 사물일 수도 있고,
시간처럼 추상적인 개념일 수도 있다. 객체는 구별 가능한 식별자, 특징적인 행동, 변경 가능한 상태를 가진다. 소프트웨어 안에서 객체는 저장된 상태와 실행 가능한 코드를 통해 구현된다.

## 상태

### 왜 상태가 필요한가

- 인간은 행동의 과정과 결과를 단순하게 기술하기 위해 상태라는 개념을 고안했다.
    - 비행기 탑승 가능 여부는 항공권의 발권 상태를 보고 예측한다.
    - 자판기는 현재까지 투입된 금액의 상태를 기억한다.
    - 텔레비전 전원이 들어온 상태여야만 채널을 변경할 수 있다.
- 상태를 이용하면 과거의 모든 행동 이력을 설명하지 않고도 행동의 결과를 쉽게 예측하고 설명할 수 있다.
- 상태는 근본적으로 세상의 복잡성을 완화하고 인지 과부하를 줄일 수 있는 중요한 개념이다.

### 상태와 프로퍼티

- 엘리스의 ‘키’와 ‘위치’는 객체가 아니다.
- 숫자, 문자열, 양, 속도, 시간, 날짜, 참/거짓과 같은 단순한 값들은 객체가 아니다.
    - 단순한 값은 객체가 아니지만 객체의 상태를 표현하기 위한 중요한 수단

![drink-me-alice-in-wonderland-madame-memento.jpg](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/1a2551b5-125f-4c05-97a8-3cc4130f9f6e/drink-me-alice-in-wonderland-madame-memento.jpg?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230220%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230220T231759Z&X-Amz-Expires=86400&X-Amz-Signature=8159caaa2cadf0fca523752e4ca955396dd998862726de001b82463fff0c6801&X-Amz-SignedHeaders=host&response-content-disposition=filename%3D%22drink-me-alice-in-wonderland-madame-memento.jpg%22&x-id=GetObject)

앨리스가 음료를 마시기 위해 병을 들고 있는 장면

- 앨리스 객체와 음료 객체는 서로 연결돼 있다.
  그러나 앨리스의 키와 위치, 음료의 양은 객체가 아닌 단순한 값이다.
- 따라서 앨리스의 상태는 키와 위치라는 단순한 값과 음료라는 객체의 조합으로 표현할 수 있다.

![Untitled](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/38f93359-f11a-497b-9c7c-e8d9ae66f05b/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230220%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230220T231811Z&X-Amz-Expires=86400&X-Amz-Signature=dd493f45be1c3e0ed5aeebc2268d63387b0b8f74bc7ddfe17e3165fb5cd5b5cf&X-Amz-SignedHeaders=host&response-content-disposition=filename%3D%22Untitled.png%22&x-id=GetObject)

결론적으로 모든 객체의 상태는 단순한 값과 객체의 조합으로 표현할 수 있다.

이때 객체의 상태를 구성하는 모든 특징을 통틀어 객체의 **프로퍼티(property)**라고 한다.

- 앨리스의 경우 키, 위치, 음료가 앨리스의 프로퍼티가 된다.
- 일반적으로 프로퍼티는 변경되지 않고 고정되기 때문에 ‘정적’이다.
  반면 **프로퍼티 값(property value)**은 시간이 흐름에 따라 변경되기 때문에 ‘동적’이다.

객체가 서로 선이 연결되어 있는데, 객체와 객체 사이의 의미 있는 연결을 **링크(link)**라고 한다.

객체는 링크를 통해서만 메시지를 주고받을 수 있다.

- 링크는 객체가 다른 객체를 참조할 수 있다는 것을 의미합니다.
- 일반적으로 한 객체가 다른 객체의 식별자를 알고 있는 것으로 표현된다.

객체 간의 선으로 표현되는 링크와 달리 객체를 구성하는 단순한 값은 **속성(attribute)**라고 한다.

> 상태는 특정 시점에 객체가 가지고 있는 정보의 집합으로 객체의 특징을 표현한다.
객체의 상태는 객체에 존재하는 정적인 프로퍼티와 동적인 프로퍼티 값으로 구성된다.
객체의 프로퍼티는 단순한 값과 다른 객체를 참조하는 링크로 구분할 수 있다.
>

객체지향의 세계에서 객체는 자율적인 존재이지만, 다른 객체의 상태에 직접적으로 접근 및 변경 할 수 없다. 자율적인 객체는 스스로 자신의 상태를 책임져야 한다.

외부의 객체가 직접적으로 객체의 상태를 주무를 수 없다면 간접적으로 객체의 상태를 변경하거나 조회할 수 있는 방법이 바로 **행동**이다.

## 행동

객체의 상태를 변경하는 것은 객체의 자발적인 행동뿐이다.

- 엘리스가 키가 작아진 이유는 앨리스가 음료를 마셨기 때문이다.

객체가 취하는 행동은 객체 자신의 상태를 변경시킨다.

객체의 행동에 의해 객체의 상태가 변경된다는 것은 행동이 **부수 효과(side effect)**를 초래한다는 것을 의미한다.

### 상태와 행동 사이의 관계

- 객체의 행동은 상태에 영향을 받는다.
- 객체의 행동은 상태를 변경시킨다.

### 상태라는 개념을 이용해 서술한 행동의 두 가지 관점

- 상호작용이 현재의 상태에 어떤 방식으로 의존하는가
- 상호작용이 어떻게 현재의 상태를 변경 시키는가

### 협력과 행동

- 객체는 자신에게 주어진 책임을 완수하기 위해 다른 객체를 이용하고 다른 객체에게 서비스를 제공한다.
- 객체는 다른 객체와 적극적으로 상호작용하며 ‘협력하는 객체들의 공동체’에 참여하기 위해 노력한다.

객체는 수신된 메시지에 따라 적절히 행동하면서 협력에 참여하고 그 결과로 자신의 상태를 변경.

### 객체의 행동으로 오는 부수 효과 두 가지

- 객체 자신의 상태 변경
- 행동 내에서 협력하는 다른 객체에 대한 메시지 전송

### 책에서 정의한 행동

> 행동이란 외부의 요청 또는 수신된 메시지에 응답하기 위해 동작하고 반응하는 활동이다.
행동의 결과로 객체는 자신의 상태를 변경하거나 다른 객체에게 메시지를 전달할 수 있다.
객체는 행동을 통해 다른 객체와의 협력에 참여하므로 행동은 외부에 가시적이어야 한다.
>

### 상태 캡슐화

![Untitled](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/15a7e5c9-90c7-4894-b817-4e0e6c7cc335/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230220%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230220T231826Z&X-Amz-Expires=86400&X-Amz-Signature=ba534083439a894619c5d197a5eb27d2be12ade9dfcadc55b1ea86899047a6a3&X-Amz-SignedHeaders=host&response-content-disposition=filename%3D%22Untitled.png%22&x-id=GetObject)

- 엘리스는 음료의 양이 줄어들 것이라는 것을 믿고 요청을 음료에게 전달한다.
- 객체지향의 세계에서 음료의 상태는 음료가 변경한다.

### 캡슐화

음료 객체(메시지 수신자)에게 메시지를 전송하는 앨리스 객체(메시지 송신자)는 음료의 상태 변경에 대해서는 전혀 알지 못하는 것이 캡슐화가 의미하는 것이다.

- 객체는 상태를 캡슐 안에 감춰둔 채 외부로 노출하지 않는다.
- 객체가 외부에 노출하는 것은 행동뿐이다.
- 외부에서 객체에 접근할 수 있는 유일한 방법 역시 행동뿐이다.

### 결론

상태를 잘 정의된 행동 집합 뒤로 캡슐화 하는 것은 객체의 자율성을 높이고 협력을 단순하고 유연하게 만든다. 이것이 상태를 캡슐화해야 하는 이유다.

## 식별자

객체란 인간의 인지 능력을 이용해 식별 가능한 경계를 가진 모든 사물을 의미한다.
객체가 식별 가능하다는 것은 객체를 서로 구별할 수 있는 특정한 프로퍼티가 객체 안에 존재 한다는 것을 의미한다. 이 프로퍼티를 **식별자**라고 한다.

모든 객체는 식별자를 가지며 식별자를 이용해 객체를 구별할 수 있다.

### 값의 동등성(equality)

- 값의 상태는 변하지 않기 때문에 불변 상태(immutable state)이다.
    - 숫자, 문자열, 날짜, 시간, 금액
- 값이 같은지 여부는 상태가 같은지를 이용해 판단한다.
- 값의 상태가 같으면 두 인스턴스는 동일한 것으로 판단하고
  상태가 다르면 두 인스턴스는 다른 것으로 판단한다.

이처럼 상태를 이용해 두 값이 같은지 판단할 수 있는 성질을 **동등성(equality)**이라고 한다.

상태를 이용해 동등성을 판단할 수 있는 이유는 값을 상태가 변하지 않기 때문이다.

### 객체는 가변 상태(mutable state)를 가진다

- 객체는 시간에 따라 변경되는 상태를 포함하며, 행동을 통해 상태를 변경한다.
- 타입이 같은 두 객체의 상태가 완전히 똑같더라도 두 객체는 독립적인 별개의 객체로
  다뤄야 한다.

두 객체의 상태가 다르더라도 식별자가 같다면 두 객체를 같은 객체로 판단할 수 있다.

이처럼 식별자를 기반으로 객체가 같은지를 판단할 수 있는 성징을 **동일성(identical)**이라고 한다.

> **식별자란** 어떤 ****객체를 다른 객체와 구분하는 데 사용하는 객체의 프로퍼티다.
값은 식별자를 가지지 않기 때문에 상태를 이용한 동등성 검사를 통해 인스턴스를 비교해야 한다. 객체는 상태가 변경될 수 있기 때문에 식별자를 이용한 동일성 검사를 통해 두 인스턴스를 비교할 수 있다.
>
- **참조 객체(reference object)**, 또는 **엔티티(entity)**는 식별자를 지닌 전통적인 의미의 객체를 가리키는 용어다.
- **값 객체(value object)**는 식별자를 가지지 않는 값을 가리키는 용어다.

*이 책에서는 객체라는 용어는 식별자를 가지는 참조 객체나 엔티티를 가리킨다.

### 객체의 중요한 특성 요약본

- 객체는 상태를 가지며 상태는 변경 가능하다.
- 객체는 상태를 변경시키는 것은 객체의 행동이다.
    - 행동의 결과는 상태에 의존적이며 상태를 이용해 서술할 수 있다.
    - 행동의 순서가 실행 결과에 영향을 미친다.
- 객체는 어떤 상태에 있더라도 유일하게 식별 가능하다.

# 4️⃣기계로서의 객체(60p)

---

### 쿼리(query)와 명령(command)

- 쿼리 : 일반적으로 객체의 상태를 조회하는 작업
- 명령 : 객체의 상태를 변경하는 작업

### 버트란드 마이어의 기계로서의 객체

- 차가운 금속 외피로 둘러싸인 블랙박스
- 기계의 부품은 단단한 금속 안에 있기 때문에 분해하지 않으면 기계의 내부를 직접 볼 수 없다.
- 사람은 기계의 외부에 부착된 사각형과 원 모양의 버튼으로만 기계와 상호작용 할 수 있다.
    - 사각형 모양의 버튼을 누르면 객체의 상태를 변경
    - 원 모양의 버튼을 눌러 객체의 상태를 조회
      ⇒ 객체의 상태는 우측 상단 디스플레이 창에 출력
    - 객체에 접근할 수 있는 유일한 방법은 객체가 제공하는 행동뿐이다.
      ⇒ 사용자는 객체가 제공하는 명령 버튼과 쿼리 버튼으로 구성된 인터페이스를 통해서만 객체에 접근할 수 있다.

객체 기계가 제공하는 버튼을 통해서만 상태에 접근할 수 있다는 점은 객체의 캡슐화를 강조한다.

![Untitled](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/f2e03d15-759b-4afe-9cc2-a9c858154a8c/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20230220%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20230220T231843Z&X-Amz-Expires=86400&X-Amz-Signature=e0d300b364d40c10ca9a585d9025487d0af722241f112f118ed8a83286539249&X-Amz-SignedHeaders=host&response-content-disposition=filename%3D%22Untitled.png%22&x-id=GetObject)

객체를 기계로서 바라보는 관점은 상태, 행동, 식별자에 대한 시각적인 이미지를 제공하고

캡슐화와 메시지를 통한 협력 관계를 매우 효과적으로 설명한다.

# 5️⃣행동이 상태를 결정한다.

---

상태를 먼저 결정하고 행동을 나중에 결정하는 방법은 설계에 나쁜 영향을 끼친다.

1. 상태를 먼저 결정할 경우 캡슐화가 저해된다.
    - 상태에 초점을 맞출 경우 상태가 객체 내부로 깔끔하게 캡슐화되지 못하고 공용 인터페이스에 그대로 노출되버릴 확률이 높아진다.
2. 객체를 협력자가 아닌 고립된 섬으로 만든다.
    - 객체는 애플리케이션의 문맥 내에서 다른 객체와 협력하기 위해서 있는데,
      상태를 먼저 고려하면 협력이라는 문맥에서 멀리 벗어난 채 객체를 설계하게 된다.
      ⇒ 자연스럽게 협력에 적합하지 못한 객체를 창조
3. 객체의 재사용성이 저하된다.
    - 재사용성은 다양한 협력에 참여할 수 있는 능력에서 나온다.
    - 상태에 초점을 맞춘 객체는 다양한 협력에 참여하기 어렵다 ⇒ 재사용성 저하

객체의 행동은 객체가 협력에 참여하는 유일한 방법이다.

- 설계자로서 협력의 문맥에 맞는 적절한 행동을 수행하는 객체를 발견 및 창조해야 한다.
- 애플리케이션 안에서 어떤 행동을 원하느냐가 어떤 객체가 적합한지를 결정한다.
- 책임-주도 설계(Responsibility-Driven Design, RDD)

# 6️⃣은유와 객체

---

## 두 번째 도시전설

> 객체지향이란 현실 세계의 모방
>

현실 세계를 면밀히 관찰하고 그 안에 존재하는 실제 객체들의 특징을 간추리고 요약해서 소프트웨어 객체로 추상화할 수 있는 능력이 중요하다는 생각이 자리 잡고 있다.

### 객체지향 세계는 현실 세계의 모방이 아니다

- 소프트웨어 안에 구현된 상품 객체는 실제 세계의 상품과는 전혀 다른 양상을 띤다.
- 소프트웨어 상품은 실제 세계의 상품이 하지 못하는 가격 계산과 같은 행동을 스스로 수행할 수 있다.
  ⇒ 소프트웨어 상품이 실제 세계의 상품을 단순화하거나 추상화한 것이 아니라 특성이 전혀 다른 어떤 것임을 의미

## 의인화

현실 속에서는 수동적인 소프트웨어 객체로 구현될 때는 능동적으로 변한다.

- 현실 객체가 가지지 못한 추가적인 능력을 보유하게 된다.
- 현실 세계에는 존재조차 하지 않는 것들도 소프트웨어 안에서는 생생한 생명을 가진 존재로 재탄생한다.

소프트웨어 안에 구축되는 객체지향 세계는 현실을 모방❌

- 현실의 모습을 조금 참조할 뿐 궁극적인 목적은 현실과 전혀 다른 새로운 세계를 창조

객체지향의 세계는 현실의 추상화 ❌

- 객체지향 세계의 거리는 현실 속의 객체보다 더 많은 특징과 능력을 보유한 객체들로 넘쳐난다.

## 은유

실제로는 적용되지 않는 한 가지 개념을 이용해 다른 개념을 서술하는 대화의 한 형태

- 한 종류의 사물을 다른 사물 관점에서 이해하고 경험하는 데 있다.
- 은유라는 말은 그리스어인 ‘transfer(옮기다)’에서 유래됐는데, 은유가 하나의 의미를 다른 것을 이용해 전달한다는 의미를 가지고 있기 때문이다.

### 은유의 장점

- 은유는 **표현적 차이(representational gap)** 또는 **의미적 차이(semantic gap)**라는 논점과 관련성이 깊다.
- 차이
  ⇒ 소프트웨어에 대해 사람들이 생각하는 모습과 실제 소프트웨어의 표현 사이의 차이를 의미
- 소프트웨어 객체에 대한 현실 객체의 은유를 효과적으로 사용할 경우 표현적 차이를 줄인다.
- 이해하기 쉽고 유지보수가 용이한 소프트웨어를 만들 수 있다.
- 객체지향 지침서에서는 현실 세계인 도메인에서 사용되는 이름을 객체에게 부여하라고 가이드

## 이상한 나라를 창조하라

- 객체지향 설계자로서 우리의 목적은 현실을 모방하는 것이 아니다.
    - 이상한 나라를 창조
- 현실을 닮아야 한다는 어떤 제약이나 구속도 없다.
- 창조한 객체의 특성을 상기시킬 수 있다면 현실 속의 객체의 이름을 이용해 객체를 묘사하라.
    - 그렇지 않다면 깔끔하게 현실을 무시하고 자유롭게 새로운 세계 창조